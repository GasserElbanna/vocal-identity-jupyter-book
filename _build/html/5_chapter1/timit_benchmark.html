
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TIMIT Benchmark &#8212; MSc. Thesis</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Datasets" href="datasets_experiments.html" />
    <link rel="prev" title="VoxCeleb 1 Benchmark" href="voxceleb_benchmark.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/speech_logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">MSc. Thesis</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Speaker Identity Perception
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Research Questions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../2_research_questions/questions.html">
   Research Questions
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Methods
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_methods/1_models/models.html">
   Speech Models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../4_methods/1_models/handcrafted_models.html">
     Handcrafted Models
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../4_methods/1_models/_handcrafted/log-mel-spec.html">
       Log-Mel-Spectrogram
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../4_methods/1_models/_handcrafted/cochleagram.html">
       Cochleagram
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../4_methods/1_models/_handcrafted/opensmile.html">
       openSMILE
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../4_methods/1_models/self-supervised_models.html">
     Self-supervised Models
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../4_methods/1_models/_data_driven/generative_models.html">
       Generative Models
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4_methods/2_pipeline/pipeline.html">
   Pipeline and Analysis
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapter 1 (Computational)
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="datasets_benchmarks.html">
   Benchmarks
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="voxceleb_benchmark.html">
     VoxCeleb 1 Benchmark
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     TIMIT Benchmark
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="datasets_experiments.html">
   Experiments
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="reverse_speech_analysis.html">
     Forward vs. Backward Speech Experiment
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="scriptvsspon_analysis.html">
     Scripted vs Spontaneous Speech
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="bilingual_speech_analysis.html">
     Bilingual Speech Experiment
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pitch_sweeping_analysis.html">
     Steady vs. Sweeping Pitch of Vowels Experiment
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pitchshift_analysis.html">
     Pitch-shifting Speech Experiment
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="emotion_speech_analysis.html">
     Emotion Speech Experiment
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="clearvsbabbling_bkg_analysis.html">
     Clear vs. Babbling Background Experiment
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapter 2 (Behavioral)
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../6_chapter2/behavioral_exp_datasets.html">
   Stimuli Selection
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapter 3 (Neuroimaging)
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_chapter3/fmriprep.html">
   fMRIPrep
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/5_chapter1/timit_benchmark.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F5_chapter1/timit_benchmark.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/5_chapter1/timit_benchmark.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dataset">
   Dataset:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluation-details">
   Evaluation Details:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluation-results">
   Evaluation Results:
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     1) TIMIT Benchmark
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#layer-wise-analysis">
     2) Layer-wise Analysis
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#centered-kernel-alignment-cka">
     3) Centered Kernel Alignment (CKA)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#discussion">
   Discussion:
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>TIMIT Benchmark</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dataset">
   Dataset:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluation-details">
   Evaluation Details:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#evaluation-results">
   Evaluation Results:
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     1) TIMIT Benchmark
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#layer-wise-analysis">
     2) Layer-wise Analysis
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#centered-kernel-alignment-cka">
     3) Centered Kernel Alignment (CKA)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#discussion">
   Discussion:
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="timit-benchmark">
<h1>TIMIT Benchmark<a class="headerlink" href="#timit-benchmark" title="Permalink to this headline">¶</a></h1>
<p>In this section, we benchmark the perofrmance of different handcrafted and data-driven features against a speaker recognition task using TIMIT dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">deciphering_enigma</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">deciphering_enigma.settings</span> <span class="kn">import</span> <span class="n">_MODELS_WEIGHTS</span><span class="p">,</span> <span class="n">palette</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">cm</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">font_manager</span><span class="o">.</span><span class="n">_fmcache</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">font_manager</span><span class="o">.</span><span class="n">_rebuild</span><span class="p">()</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Times New Roman&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-11-02 19:22:44 | INFO | matplotlib.font_manager | Generating new fontManager, this may take some time...
</pre></div>
</div>
</div>
</div>
<div class="section" id="dataset">
<h2>Dataset:<a class="headerlink" href="#dataset" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://catalog.ldc.upenn.edu/LDC93s1">TIMIT</a> is a read speech corpus that comprises 630 speakers uttering ten phonetically rich sentences with total of 6300 utterances. The dataset has speakers of eight different dialects of American English. We used this corpus as a speaker recognition downstream task. We extracted all handcrafted and data-driven features from this dataset and benchmarked the models’ performances. We trained a classifier on seven randomly-selected scentences per speaker and kept three scentences for testing.</p>
</div>
<div class="section" id="evaluation-details">
<h2>Evaluation Details:<a class="headerlink" href="#evaluation-details" title="Permalink to this headline">¶</a></h2>
<p>The evaluation pipeline includes extracting the features of TIMIT utterances from each model (handcrfated or self-supervised). The features of each utterance is temporally pooled using <em>mean+max</em> to generate 1D vector per sample. Then, we trained a single linear layer classifier to fit the features from the train set of TIMIT using adam optimizer with early stopping after patience of 10 epochs. The classifier trains for 200 epochs with learning being tuned to optimize the results between 0.0001 to 0.01, we manually checked lower learning rate values that yielded worst results. Also we tuned the number of nodes in the linear layer with values 10, 50 and 100 nodes. The features were standardized before training the linear classifier. We ran this process ten times for each model and reported the <em>unweighted average recall</em> (UAR) percentage. We used <em>scikit-learn</em> package to benchmark the downstream task.</p>
</div>
<div class="section" id="evaluation-results">
<h2>Evaluation Results:<a class="headerlink" href="#evaluation-results" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>1) TIMIT Benchmark<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>In the Figure below, we reported the average UAR percentage for each model with 95% confidence interval.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s1">&#39;/om2/user/gelbanna/timit_benchmark/*/*results.csv&#39;</span><span class="p">)</span>
<span class="n">files</span> <span class="o">+=</span> <span class="n">glob</span><span class="p">(</span><span class="s1">&#39;/om2/user/gelbanna/voxceleb_1/*/*finallayer.csv&#39;</span><span class="p">)</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">file</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span> <span class="k">if</span> <span class="s1">&#39;encoder&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">and</span> <span class="s1">&#39;conv&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">and</span> <span class="s1">&#39;bootstrap&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file</span><span class="p">]</span>
<span class="n">dfs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
    <span class="n">dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dfs</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Score&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/om2/user/gelbanna/timit_benchmark/benchmark_scores.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/om2/user/gelbanna/timit_benchmark/benchmark_scores.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">order</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Model&#39;</span><span class="p">)[</span><span class="s1">&#39;Score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Model&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Score&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">(),</span> <span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;UAR (%)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Models&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/timit_benchmark_13_0.png" src="../_images/timit_benchmark_13_0.png" />
</div>
</div>
</div>
<div class="section" id="layer-wise-analysis">
<h3>2) Layer-wise Analysis<a class="headerlink" href="#layer-wise-analysis" title="Permalink to this headline">¶</a></h3>
<p>To thoroughly examine a model’s performance, evaluating the intermediate representations across layers might elucidate the model’s best layer for a downstream task. Moreover, the three models (Wav2Vec2, HuBERT and Data2Vec) share similar architectural structures comprising layers of CNN followed by layers of transformers. Thus, as shown in Figure below, we also benchmarked the performance of the latent features generated from the last CNN layer in these models and the contextual features generated from the last transformer layer which happens to be the features examined in the Figure above. Additionally, we reported the performance of the best layer for Wav2Vec2 and HuBERT which happens to be transformer 1st and 7th layers respectively. While for Data2Vec we found that the best performing layer is the last convolutional layer which generates latent representations.</p>
<p><img alt="latent_contextual_figure.png" src="../_images/latent_contextual_figure.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/om2/user/gelbanna/timit_benchmark/layerwise_analysis.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">palette</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Wav2Vec2&#39;</span><span class="p">:</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span> <span class="s1">&#39;HuBERT&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;Data2Vec&#39;</span><span class="p">:</span> <span class="s1">&#39;#1f77b4&#39;</span><span class="p">}</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Layer&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Score&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Model&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Layer</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Layer</span><span class="o">.</span><span class="n">unique</span><span class="p">(),</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">Model</span><span class="o">==</span><span class="s1">&#39;Data2Vec&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Layer</span><span class="o">==</span><span class="s1">&#39;conv_6&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">Model</span><span class="o">==</span><span class="s1">&#39;HuBERT&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Layer</span><span class="o">==</span><span class="s1">&#39;transf_6&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">Model</span><span class="o">==</span><span class="s1">&#39;Wav2Vec2&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Layer</span><span class="o">==</span><span class="s1">&#39;transf_0&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;UAR (%)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Layers&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/timit_benchmark_18_0.png" src="../_images/timit_benchmark_18_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/om2/user/gelbanna/timit_benchmark/facebook_models.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Wav2Vec2&#39;</span><span class="p">,</span> <span class="s1">&#39;HuBERT&#39;</span><span class="p">,</span> <span class="s1">&#39;Data2Vec&#39;</span><span class="p">]</span>
<span class="n">hue_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;latent&#39;</span><span class="p">,</span> <span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="s1">&#39;contextual&#39;</span><span class="p">]</span>
<span class="n">palette</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;latent&#39;</span><span class="p">:</span> <span class="s1">&#39;lightseagreen&#39;</span><span class="p">,</span> <span class="s1">&#39;best&#39;</span><span class="p">:</span><span class="s1">&#39;mediumpurple&#39;</span><span class="p">,</span> <span class="s1">&#39;contextual&#39;</span><span class="p">:</span><span class="s1">&#39;lightslategrey&#39;</span><span class="p">}</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Score&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;Layer&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">hue_order</span><span class="o">=</span><span class="n">hue_order</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_axis_labels</span><span class="p">(</span><span class="s2">&quot;Models&quot;</span><span class="p">,</span> <span class="s2">&quot;UAR (%)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/timit_benchmark_20_0.png" src="../_images/timit_benchmark_20_0.png" />
</div>
</div>
</div>
<div class="section" id="centered-kernel-alignment-cka">
<h3>3) Centered Kernel Alignment (CKA)<a class="headerlink" href="#centered-kernel-alignment-cka" title="Permalink to this headline">¶</a></h3>
<p>Additionally, we further measured the representation similaritites across all models. The method used as a proxy for embeddings similaritiy is <strong>Centered Kernel Alignment</strong> (CKA). It is a dot product-based method used to study similarities across representations generated by deep neural networks. CKA computes similarity by normalizing <strong>Hilbert-Schmidt Independence Criterion</strong> (HSIC) to be invariant to isotropic scaling, as shown below.</p>
<p><img alt="" src="../_images/cka_formula.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#define the experiment config file path</span>
<span class="n">path_to_config</span> <span class="o">=</span> <span class="s1">&#39;./config.yaml&#39;</span>

<span class="c1">#read the experiment config file</span>
<span class="n">exp_config</span> <span class="o">=</span> <span class="n">deciphering_enigma</span><span class="o">.</span><span class="n">load_yaml_config</span><span class="p">(</span><span class="n">path_to_config</span><span class="p">)</span>
<span class="n">dataset_path</span> <span class="o">=</span> <span class="n">exp_config</span><span class="o">.</span><span class="n">dataset_path</span>

<span class="c1">#register experiment directory and read wav files&#39; paths</span>
<span class="n">audio_files</span> <span class="o">=</span> <span class="n">deciphering_enigma</span><span class="o">.</span><span class="n">build_experiment</span><span class="p">(</span><span class="n">exp_config</span><span class="p">)</span>
<span class="n">audio_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">audio</span> <span class="k">for</span> <span class="n">audio</span> <span class="ow">in</span> <span class="n">audio_files</span> <span class="k">if</span> <span class="n">audio</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_normloud.wav&#39;</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dataset has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">audio_files</span><span class="p">)</span><span class="si">}</span><span class="s1"> samples&#39;</span><span class="p">)</span>

<span class="c1">#extract metadata from file name convention</span>
<span class="n">metadata_df</span><span class="p">,</span> <span class="n">audio_format</span> <span class="o">=</span> <span class="n">deciphering_enigma</span><span class="o">.</span><span class="n">extract_metadata</span><span class="p">(</span><span class="n">exp_config</span><span class="p">,</span> <span class="n">audio_files</span><span class="p">)</span>
<span class="n">metadata_df</span><span class="p">[</span><span class="s1">&#39;AudioPath&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">audio_files</span>
<span class="n">metadata_df</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">audio_files</span><span class="p">)))</span>
<span class="n">metadata_df</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">audio_files</span><span class="p">)))</span>

<span class="c1">#load audio files as torch tensors to get ready for feature extraction</span>
<span class="n">audio_tensor_list</span> <span class="o">=</span> <span class="n">deciphering_enigma</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="n">audio_files</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">exp_config</span><span class="p">,</span> <span class="n">speaker_ids</span><span class="o">=</span><span class="n">metadata_df</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">],</span> <span class="n">audio_format</span><span class="o">=</span><span class="n">audio_format</span><span class="p">)</span>
<span class="c1">#generate speech embeddings</span>
<span class="n">feature_extractor</span> <span class="o">=</span> <span class="n">deciphering_enigma</span><span class="o">.</span><span class="n">FeatureExtractor</span><span class="p">()</span>
<span class="n">embeddings_dict</span> <span class="o">=</span> <span class="n">feature_extractor</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">audio_tensor_list</span><span class="p">,</span> <span class="n">exp_config</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset has 6300 samples
Audio Tensors are already saved for timit_benchmark
Load Log-Mel-Spectrogram Model
Log-Mel-Spectrogram embeddings are already saved for timit_benchmark
(6300, 128)
Load Cochleagram Model
Cochleagram embeddings are already saved for timit_benchmark
(6300, 85)
Load openSMILE_eGeMAPS Model
openSMILE_eGeMAPS embeddings are already saved for timit_benchmark
(6300, 88)
Load openSMILE_ComParE Model
openSMILE_ComParE embeddings are already saved for timit_benchmark
(6300, 6373)
Load BYOL-A_default Model
BYOL-A_default embeddings are already saved for timit_benchmark
(6300, 2048)
Load BYOL-S_default Model
BYOL-S_default embeddings are already saved for timit_benchmark
(6300, 2048)
Load BYOL-I_default Model
BYOL-I_default embeddings are already saved for timit_benchmark
(6300, 2048)
Load BYOL-S_cvt Model
BYOL-S_cvt embeddings are already saved for timit_benchmark
(6300, 2048)
Load Hybrid_BYOL-S_cvt Model
Hybrid_BYOL-S_cvt embeddings are already saved for timit_benchmark
(6300, 2048)
Load TERA Model
TERA embeddings are already saved for timit_benchmark
(6300, 768)
Load APC Model
APC embeddings are already saved for timit_benchmark
(6300, 512)
Load Wav2Vec2_latent Model
Wav2Vec2_latent embeddings are already saved for timit_benchmark
(6300, 512)
Load Wav2Vec2_best Model
Wav2Vec2_best embeddings are already saved for timit_benchmark
(6300, 1024)
Load Wav2Vec2 Model
Wav2Vec2 embeddings are already saved for timit_benchmark
(6300, 1024)
Load HuBERT_latent Model
HuBERT_latent embeddings are already saved for timit_benchmark
(6300, 512)
Load HuBERT_best Model
HuBERT_best embeddings are already saved for timit_benchmark
(6300, 1280)
Load HuBERT Model
HuBERT embeddings are already saved for timit_benchmark
(6300, 1280)
Load Data2Vec_latent Model
Data2Vec_latent embeddings are already saved for timit_benchmark
(6300, 512)
Load Data2Vec_best Model
Data2Vec_best embeddings are already saved for timit_benchmark
(6300, 512)
Load Data2Vec Model
Data2Vec embeddings are already saved for timit_benchmark
(6300, 1024)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cka_class</span> <span class="o">=</span> <span class="n">deciphering_enigma</span><span class="o">.</span><span class="n">CKA</span><span class="p">(</span><span class="n">unbiased</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">rbf_threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">cka_</span> <span class="o">=</span> <span class="n">cka_class</span><span class="o">.</span><span class="n">run_cka</span><span class="p">(</span><span class="n">embeddings_dict</span><span class="p">,</span> <span class="n">save_path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;../</span><span class="si">{</span><span class="n">exp_config</span><span class="o">.</span><span class="n">dataset_name</span><span class="si">}</span><span class="s1">/&#39;</span><span class="p">,</span> <span class="n">save_array</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cka_class</span> <span class="o">=</span> <span class="n">cka_class</span><span class="o">.</span><span class="n">plot_heatmap</span><span class="p">(</span><span class="n">cka_</span><span class="p">,</span> <span class="n">embeddings_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">save_path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;../</span><span class="si">{</span><span class="n">exp_config</span><span class="o">.</span><span class="n">dataset_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">save_fig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CKA is already saved
</pre></div>
</div>
<img alt="../_images/timit_benchmark_25_1.png" src="../_images/timit_benchmark_25_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="discussion">
<h2>Discussion:<a class="headerlink" href="#discussion" title="Permalink to this headline">¶</a></h2>
<p>In this section, we have benchmarked the performance of several handcrafted and data-driven models on a speaker recognition task using TIMIT dataset. We have observed that the best-performing models on TIMIT and VoxCeleb datasets are <strong>TERA</strong> and <strong>Hybrid BYOL-S</strong>. Additionally for TIMIT task the last convolutional layer in <strong>Data2Vec</strong> is yielding the best performance. Surprisingly, we noticed that the state-of-the-art self-supervised models such as <em>HuBERT</em>, <em>Wav2Vec 2.0</em> and <em>Data2Vec</em> have featured significantly low predictive power compared to DSP-based features (openSMILE) and spectrograms. Accordingly, we applied layerwise analysis to further elucidate the performance across all layers in the aforementioned models. That said, it was observed that earlier layers have shown higher performance compared to final ones, suggesting that these models maximized speaker-related information coding in earlier layers. In retrospect, one can argue that this behavior is quite intuitive given the training pretext task these models optimized. These models were mainly trained to predict hidden/masked speech units making the model focus on prioritizing language and phonetic information above speaker-related information. Hence, the degraded performance as we move to final layers. It is worth mentioning that the best-performing layers for three models outperformed the top models for this task as shown in the first figure. Lastly, we computed a similarity metric (CKA) across different representations. As shown in the figure above, the final layer representations from HuBERT, Wav2Vec 2.0 and Data2Vec showed the lowest CKA scores with the rest of the models indicating that these representations might encode different information compared to other models. However, they share high CKA scores between each other.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./5_chapter1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="voxceleb_benchmark.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">VoxCeleb 1 Benchmark</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="datasets_experiments.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Datasets</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Gasser Elbanna<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>